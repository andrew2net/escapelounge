#start-game-modal.modal.fade
  .modal-dialog
    .modal-content
      .modal-header
        %h5.modal-title
          Starting game
          = "\"#{@game.name}\""
        %button.close{ type: 'button', data: { dismiss: 'modal' } }
          %span &times;
      .modal-body
        %p
          You are about start a game. The game has several steps. Each step is a question.
          The goal of the gamime is completing it as fast as you can. When you start game a timer will starts countdown.
          You should answer a question before go to next step. Each step has hints and each hint has penalty.
          If you user a hint it reduce rest time. When you pass all steps game will be finished.
      .modal-footer
        = link_to 'Start game', game_start_url(@game), class: 'btn btn-primary',
          id: 'start-game-btn'

#game-show
  .page-head
    .container
      .row
        .col-md-10
          %h4= @game.name
        -if current_user && current_user.admin
          .col-md-2
            = link_to 'Edit', edit_admin_game_path(@game),
              class: "btn btn-sm btn-primary", id: 'start-game-btn'

  %section
    = image_tag @game.background.url, class: 'img-fluid game-back-img'
    .container
      .row
        .col-md-5

          %p
            %b Description:
            = @game.description
          %p
            %b Short Description:
            = @game.short_description
          %p
            %b Difficulty:
            = @game.difficulty
          %p
            %b Grades:
            = @game.grades.map { |g| g.name}.join ', '
          %p
            %b Max Time Alloted:
            = @game.time_length
          %p
            %b Steps:
            = @game.game_steps.count
          %p
            %b= link_to 'Instructions', @game.instructions_pdf.url

        .col-md-5
          = image_tag @game.banner.url :thumb, class: 'img-fluid'

        .col-md-2
          - if policy(@game).start?
            = display_timer

            = button_tag 'Start game', data: { target: '#start-game-modal', toggle: 'modal' },
              class: "btn btn-primary", style: "#{@running || @paused_at ? 'display:none' : ''}"
          - else
            %p You have no subscription to start the game.

      .row
        .col-md-12
          %h3.text-center Top 10
          %table.table.table-striped
            %thead
              %tr
                %th Time
                %th E-mail
            %tbody
              - @game.user_games.includes(:user).where("result>0").order(:result).first(10).each do |user_game|
                %tr
                  %td= user_game.formated_result
                  %td= user_game.user.email

      -# - @game.game_steps.each do |step|
        .step-container
          %h4= step.name
          %p= step.description

          %h5 Hints
          -# TODO: put hints into a button that triggers a modal and removes points from total score
          - step.hints.each do |hint|
            .hint-container
              %p= hint.description
              %span.hint-value= "#{hint.value} pts"

          %hr
          %h5 Solutions
          - step.game_step_solutions.each do |game_step_solution|
            .hint-container
              %p= game_step_solution.solution
